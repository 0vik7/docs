# Создать сетевой балансировщик

> [!NOTE]
>
> Перед созданием балансировщика [создайте](target-group-create.md) целевую группу, чтобы подключить ее к балансировщику.
>

---

**[!TAB Консоль управления]**

Чтобы создать [сетевой балансировщик](../concepts/index.md):
1. Откройте раздел **Load Balancer** в каталоге, где требуется создать балансировщик.
1. Нажмите кнопку **Создать балансировщик**.
1. Задайте имя балансировщика. 
    
    [!INCLUDE [name-format](../../_includes/name-format.md)]

1. Нажмите переключатель **Целевые группы**
1. Выберите заранее [созданную](target-group-create.md) целевую группу.
1. В блоке **Проверка состояния** введите имя проверки состояния.

    [!INCLUDE [name-format](../../_includes/name-format.md)]

1. Выберите тип проверки: **TCP** или **HTTP**.
1. Укажите порт из диапазона 1-32767.
1. Если вы выбрали проверку через HTTP, то укажите URL, по которому будут выполняться проверки.
1. Укажите время ожидания ответа в секундах.
1. Укажите интервал отправки проверок состояния в секундах.
1. Укажите порог работоспособности — количество успешных проверок, после которого виртуальная машина будет считаться готовой к приему трафика.
1. Укажите порог неработоспособности — количество проваленных проверок, после которого на виртуальную машину перестанет подаваться трафик.
1. Нажмите кнопку **Добавить обработчик**.
1. В открывшемся окне укажите порт из диапазона от 1 до 32767, на котором балансировщик будет принимать входящий трафик. Номер порта должен совпадать с номерами портов, на которых трафик принимают виртуальные машины.
1. Нажмите кнопку **Добавить**.
1. Нажмите кнопку **Создать балансировщик**.

**[!TAB CLI]**

Если у вас еще нет интерфейса командной строки Яндекс.Облака, [установите его](https://cloud.yandex.ru/docs/cli/quickstart#install).

[!INCLUDE [default-catalogue](../../_includes/default-catalogue.md)]

1. Посмотрите описание команды CLI для создания сетевого балансировщика:

   ```
   $ yc load-balancer network-load-balancer create --help
   ```

1. Чтобы создать балансировщик с [обработчиком](../concepts/listener.md), выполните в терминале команду:

      ```
      $ yc load-balancer network-load-balancer create \
      --region-id ru-central1 \
      --name test-load-balancer-2 \
      --listener name=test-listener,external-ip-version=ipv4,port=80
      ```

1. Получите список всех балансировщиков, чтобы убедиться, что балансировщик создан:

   ```
   $ yc load-balancer network-load-balancer list
   ```

**[!TAB API]**

Создать новый балансировщик можно с помощью метода API [create](../api-ref/NetworkLoadBalancer/create.md).

---

## Примеры

### Создание балансировщика без обработчика

---

**[!TAB CLI]**

Чтобы создать балансировщик без обработчика, выполните в терминале команду:

```
   $ yc load-balancer network-load-balancer create \
   --region-id ru-central1 \
   --name test-load-balancer-1
```

---

### Создание балансировщика с обработчиком и подключенной целевой группой

---
**[!TAB CLI]**

1. Чтобы создать балансировщик с [обработчиком](../concepts/listener.md) и сразу подключить к нему заранее [созданную](target-group-create.md) целевую группу, получите список целевых групп:

   ```
   $ yc load-balancer target-group list
   +----------------------+-------------------+---------------------+-------------+--------------+
   |          ID          |       NAME        |       CREATED       |  REGION ID  | TARGET COUNT |
   +----------------------+-------------------+---------------------+-------------+--------------+
   | b7roi767je4c574iivrk | test-target-group | 2018-12-03 14:41:04 | ru-central1 |            1 |
   +----------------------+-------------------+---------------------+-------------+--------------+
   ```
   
1. Выполните следующую команду, используя идентификатор нужной целевой группы в параметре `target-group-id`:

   ```
   $ yc load-balancer network-load-balancer create \
   --region-id ru-central1 \
   --name test-load-balancer-3 \
   --listener name=test-listener,external-ip-version=ipv4,port=80 \
   --target-group target-group-id=b7rjtf12qdeehrj31hri,healthcheck-name=http,healthcheck-interval=2s,healthcheck-timeout=1s,healthcheck-unhealthythreshold=2,healthcheck-healthythreshold=2,healthcheck-http-port=80
   ```
   Обратите внимание на формат параметров `healthcheck-interval` и `healthcheck-timeout`: необходимо указывать значение в формате `Ns`.

---