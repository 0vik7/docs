# Подключение к базе данных в кластере {{ MG }}

Внутри Яндекс.Облака подключиться к кластеру БД можно только с виртуальной машины с адресом в той же подсети Облака.

## Аутентификация

{{ MG }}-кластеры {{ mmg-short-name }} поддерживают только шифрованные соединения. Поэтому для подключения к такому кластеру необходим SSL-сертификат. Подготовить все нужные аутентификационные данные можно так:

```bash
$ mkdir ~/.mongodb
$ wget "https://{{ s3-storage-host }}{{ pem-path }}" -O ~/.mongodb/CA.pem
$ chmod 0600 ~/.mongodb/CA.pem
```

## Строка подключения

Теперь вы можете подключиться к БД с помощью команды `mongo`, перечислив все хосты кластера в значении параметра `host`:

```bash
$ mongo --norc \
        --ssl \
        --sslCAFile ~/.mongodb/CA.pem \
        --host 'rs01/<адрес хоста 1>:27018,<адрес хоста 2>:27018,<адрес хоста N>:27018' \
        -u <имя пользователя> \
        -p <пароль пользователя> \
        <имя БД>
```

Запросы на запись будут автоматически направлены в первичный хост кластера.

Адреса всех хостов в кластере БД можно найти на странице нужного кластера в консоли управления.

