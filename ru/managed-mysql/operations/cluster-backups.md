# Управление резервными копиями

Вы можете создавать [резервные копии](../concepts/backup.md) и восстанавливать кластеры из имеющихся резервных копий.


## Восстановить кластер из резервной копии {#restore}

Восстанавливая кластер из резервной копии, вы создаете новый кластер с данными из резервной копии. Если в каталоге не хватает [ресурсов](../concepts/limits.md) для создания такого кластера, восстановиться из резервной копии не получится.

Для нового кластера необходимо задать все параметры, обязательные при создании, кроме типа кластера (резервную копию {{ CH }} не получится восстановить как кластер {{ MY }}).

{% list tabs %}

- Консоль управления
  
  1. Перейдите на страницу каталога и выберите сервис **{{ mmy-name }}**.
  1. Нажмите на имя нужного кластера и выберите вкладку **Резервные копии**.
  1. Нажмите значок ![image](../../_assets/dots.svg) для нужной резервной копии, затем нажмите **Восстановить кластер**. 
  1. Задайте настройки нового кластера. В списке **Каталог** можно выбрать каталог для нового кластера.
  1. Нажмите кнопку **Восстановить кластер**.
  
  {{ mmy-name }} запустит операцию создания кластера из резервной копии.
  
{% endlist %}


## Создать резервную копию {#create-backup}

{% list tabs %}

- Консоль управления
  
  1. Перейдите на страницу каталога и выберите сервис **{{ mmy-name }}**.
  1. Нажмите на имя нужного кластера и выберите вкладку **Резервные копии**.
  1. Нажмите кнопку **Создать резервную копию**.
  
{% endlist %}


## Получить список резервных копий {#list-backups}

{% list tabs %}

- Консоль управления
  
  1. Перейдите на страницу каталога и выберите сервис **{{ mmy-name }}**.
  1. Нажмите на имя нужного кластера и выберите вкладку **Резервные копии**.

- CLI

  {% include [cli-install](../../_includes/cli-install.md) %}
  
  {% include [default-catalogue](../../_includes/default-catalogue.md) %}
  
  Чтобы получить список резервных копий кластеров {{ MY }}, доступных в каталоге по умолчанию, выполните команду:
  
  ```
  $ {{ yc-mdb-my }} backup list
  
  +----------------------------------------------+---------------------+----------------------+---------------------+
  |                      ID                      |     CREATED AT      |  SOURCE CLUSTER ID   |     STARTED AT      |
  +----------------------------------------------+---------------------+----------------------+---------------------+
  | c9qj5kblp2o5ra03ttns:stream_20190722T220835Z | 2019-07-22 22:08:37 | c9qj5kblp2o5ra03ttns | 2019-07-22 22:08:37 |
  | c9qj5kblp2o5ra03ttns:stream_20190721T222541Z | 2019-07-21 22:25:46 | c9qj5kblp2o5ra03ttns | 2019-07-21 22:25:46 |
  +----------------------------------------------+---------------------+----------------------+---------------------+
  ```
  
{% endlist %}


## Получить информацию о резервной копии {#get-backup}

{% list tabs %}

- Консоль управления
  
  1. Перейдите на страницу каталога и выберите сервис **{{ mmy-name }}**.
  1. Нажмите на имя нужного кластера и выберите вкладку **Резервные копии**.

- CLI
  
  {% include [cli-install](../../_includes/cli-install.md) %}
  
  {% include [default-catalogue](../../_includes/default-catalogue.md) %}
  
  Чтобы получить данные о резервной копии кластера {{ MY }}, выполните команду:
  
  ```
  $ {{ yc-mdb-my }} backup get <идентификатор резервной копии>
  ```
  
  Идентификатор резервной копии можно получить со [списком резервных копий](#list-backups).
  
{% endlist %}

## Задать время начала резервного копирования {#set-backup-window}

{% list tabs %}

- Консоль управления
  
  В консоли управления задать время начала резервного копирования можно только при [изменении кластера](update.md).

- CLI

  Чтобы задать время начала резервного копирования, используйте флаг `--backup-window-start`. Время задается в формате ``ЧЧ:ММ:СС``.

  ```
  $ yc {{ yc-mdb-my }} cluster create \
     --name <имя кластера> \
     --environment <окружение, prestable или production> \
     --network-name <имя сети> \
     --host zone-id=<зона доступности>,subnet-id=<идентификатор подсети> \
     --mysql-version <версия базы данных> \
     --resource-preset <класс хоста> \
     --backup-window-start 10:25:00  
  ```
  
  Изменить время начала резервного копирования в существующем кластере можно с помощью команды `update`:

  ```
  $ yc {{ yc-mdb-my }} cluster update \
     --name <имя кластера> \
     --backup-window-start 11:25:00
  ```

{% endlist %}
