# Разграничение прав доступа

{% if audience == "internal" %}

## Аутентификация {#authentication}

В {{ ydb-short-name }} используется аутентификация на основе токенов, которые пересылаются пользователем вместе с запросом.
На данный момент поддерживаются следующие типы токенов:

* *OAuth* — обычный OAuth токен, привязка к приложению на текущий момент не проверяется — подходит любой, проверка осуществляется через blackbox;
* *Session_id* — cookies пользователя в домене yandex-team.ru, проверка осуществляется через blackbox;
* *TVM2* — оффлайн аутентификация.

После успешной аутентификации из токена получается идентификатор пользователя (кроме TVM2), по которому, по возможности, получается список групп пользователя (из Staff). Вся полученная информация используется в дальнейшей авторизации.

## Авторизация {#authorization}

В {{ ydb-short-name }} права доступа настраиваются для каждого элемента схемы и автоматически наследуются вложенными элементами. Права доступа могуть быть выданы любому пользователю или группе (субъекту доступа). Информация о субъекте представляется в виде ```<login>@<subsystem>```. Например, для пользователей, полученных от Staff запись будет иметь вид ```<login>@staff```.

На текущий момент для настройки доступны следующие права:

* *read* — чтение данных и атрибутов схемы;
* *write* — запись данных и атрибутов схемы;
* *grant* — выдача прав доступа другим пользователям;
* *use* — чтение, запись и выдача прав (*read* + *write* + *grant*);
* *manage* — создание, изменение и удаление баз данных. Доступно только администраторам сервиса;
* *full* — полный, неограниченный доступ к сервису (*use* + *manage*).

## Создание базы данных {#create-db}

При создании базы данных через [веб-интерфейс YDB](https://ydb.yandex-team.ru/), операция выполняется от лица пользователя `robot-yandexdb`, который получает права *full* на БД. Пользователю, инициировавшему создание БД, выдаются права *use*.

Права *use* дают возможность:

* создавать и удалять таблицы и директории в БД;
* выполнять операции чтения и записи;
* выдавать права доступа другим пользователям, но только в рамках перечисленных выше прав *use*.

Управление правами в текущей версии возможно только через [С++](https://a.yandex-team.ru/arc/trunk/arcadia/kikimr/public/sdk/cpp/client/ydb_scheme.h) и [Python](https://a.yandex-team.ru/arc/trunk/arcadia/kikimr/public/sdk/python/client/scheme.py) SDK, которые содержат методы предоставления, отзыва, изменения выданного списка прав, а также метод смены владельца таблицы, директории или БД.

Пользователь не может самостоятельно изменять параметры БД или удалять БД. В настоящее время эти действия может совершать администратор системы.

{% endif %}