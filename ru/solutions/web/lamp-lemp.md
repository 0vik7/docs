# Динамический сайт на LAMP- или LEMP-стеке

Чтобы настроить статический веб-сайт или динамический сайт на PHP:
* [Создайте виртуальную машину с предустановленным веб-сервером](#create-vm)
* [Загрузите файлы веб-сайта](#upload-files)
* [Настройте DNS](#configure-dns)


## Создать виртуальную машину с предустановленным веб-сервером {#create-vm}

Перед тем, как создавать виртуальную машину:

1. Перейдите в [консоль управления](https://console.cloud.yandex.ru) Яндекс.Облака и выберите каталог, в котором будете выполнять операции.
1. Убедитесь, что в выбранном каталоге есть сеть с подсетью, к которой можно подключить виртуальную машину. Для этого на странице каталога нажмите плитку **Yandex Virtual Private Cloud**. Если в списке есть сеть — нажмите на нее, чтобы увидеть список подсетей. Если ни одной подсети или сети нет, [создайте их](../../vpc/quickstart.md).

Чтобы создать виртуальную машину:

1. На странице каталога в [консоли управления](https://console.cloud.yandex.ru) нажмите кнопку **Создать ресурс** и выберите **Виртуальная машина**.
1. В поле **Имя** введите имя виртуальной машины.

    [!INCLUDE [name-format](../../_includes/name-format.md)]

1. Выберите [зону доступности](../../overview/concepts/geo-scope.md), в которой будет находиться виртуальная машина.
1. Выберите публичный образ:
   * **LEMP** для Linux, nginx, MySQL, PHP;
   * **LAMP** для Linux, Apache, MySQL, PHP. 
   
   Для статических сайтов рекомендуется использовать **LEMP**.
 
1. В блоке **Вычислительные ресурсы** выберите [тип использования ядра](../../compute/concepts/vm-types.md) (частичное или полное), укажите необходимое количество vCPU и объем RAM.

   Для функционального тестирования хватит минимальной конфигурации:
   * **Гарантированная доля vCPU** — 5%.
   * **vCPU** — 1.
   * **RAM** — 1 ГБ.

1. В блоке **Сетевые настройки** выберите, к какой подсети необходимо подключить виртуальную машину при создании.
1. Укажите данные для доступа на виртуальную машину:
    - В поле **Логин** введите имя пользователя.
    - В поле **SSH ключ** вставьте содержимое файла открытого ключа.
        Пару ключей для подключения по SSH необходимо создать самостоятельно. Для создания ключей используйте сторонние инструменты, например утилиты `ssh-keygen` в Linux и macOS или [PuTTygen](https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html) в Windows.
1. Нажмите кнопку **Создать ВМ**.

Создание виртуальной машины может занять несколько минут. Когда виртуальная машина перейдет в статус `RUNNING`, вы можете [загрузить на нее файлы веб-сайта](#upload-files).

При создании виртуальной машине назначаются IP-адрес и имя хоста (FQDN). Эти данные можно использовать для доступа по SSH.

#### См. также

- [[!TITLE]](../../compute/operations/vm-control/vm-connect-ssh.md)


## Загрузить файлы веб-сайта {#upload-files}

[!INCLUDE [upload-files](../_solutions_includes/upload-web-site-files.md)]

## Настроить DNS {#configure-dns}

Доменное имя, которое вы хотите использовать для веб-сайта, нужно связать с созданной виртуальной машиной.

В инструкции ниже описана настройка внешнего DNS-сервиса на примере [reg.ru](https://www.reg.ru/) для доменных имен `www.example.com` и `example.com`:
  * Запись типа A позволяет сопоставить доменному имени `example.com` его IP-адрес.
  * Запись типа CNAME (Canonical Name — каноническое имя) для `www` позволит получить доступ к вашему веб-сайту через адрес `www.example.ru`.

Чтобы настроить внешний DNS-сервер, выполните:

1. В блоке **Сеть** на странице виртуальной машины в [консоли управления](https://console.cloud.yandex.ru) найдите публичный IP-адрес виртуальной машины.
1. Войдите в панель управления внешнего DNS-сервиса. Перейдите в [список ваших доменов](https://www.reg.ru/user/domain_list) и нажмите на имя нужного домена.
1. Перейдите по ссылке **Управление зоной** в блоке **Управление доменом**.
1. Создайте или отредактируйте A-запись:
   * **IP Address** — публичный IP-адрес вашей виртуальной машины.
   * **Subdomain** — `@` (указывает на основной домен).
1. Создайте CNAME-запись со значениями полей:
   * **Subdomain** — `www`.
   * **Canonical name** — `@` или домен с точкой на конце`example.com.`.
1. Подождите 15-20 минут, пока изменения DNS-записей вводятся в действие. Время ожидания может отличаться для вашего DNS-сервиса.
